BootStrap: docker
FROM python:3.9-slim

%labels
    Maintainer Vladimir Zaigrajew

%post
    apt-get update
    apt-get install -y --no-install-recommends \
        software-properties-common \
        python3-dev\
        curl
    rm -rf /var/lib/apt/lists/*
    ln -s /usr/bin/python3 /usr/local/bin/python

    pip install --no-cache-dir -r /requirements.txt

    chmod +x /workspace/run.sh

%files
    requirements.txt /requirements.txt
    run.sh /workspace/run.sh
    mnist_jax.py /workspace/mnist_jax.py
    mnist_pytorch.py /workspace/mnist_pytorch.py
    mnist_tensorflow.py /workspace/mnist_tensorflow.py

    mlcube.yaml /mlcube/mlcube.yaml
    workspace/train.yaml /mlcube/workspace/train.yaml

%runscript
    /bin/bash /workspace/run.sh "$@"